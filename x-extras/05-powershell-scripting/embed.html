<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Resources Windows PowerShell: Scripting Crash Course from Microsoft TechNet How to Write and Run Scripts in the Windows PowerShell ISE from Microsoft Windows PowerShell Scripting Tutorial for Beginners from Netwrix Video Transcript This video introduces the Windows PowerShell Integrated Scripting Environment (ISE) and covers the basics for creating and running your own scripts in Windows PowerShell.
Before we begin, we must change one system setting to allow unsigned PowerShell scripts to run."><meta name=author content="Russell Feldhausen"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Scripting :: CIS 527 Textbook"><meta name=twitter:description content="Resources Windows PowerShell: Scripting Crash Course from Microsoft TechNet How to Write and Run Scripts in the Windows PowerShell ISE from Microsoft Windows PowerShell Scripting Tutorial for Beginners from Netwrix Video Transcript This video introduces the Windows PowerShell Integrated Scripting Environment (ISE) and covers the basics for creating and running your own scripts in Windows PowerShell.
Before we begin, we must change one system setting to allow unsigned PowerShell scripts to run."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis527/x-extras/05-powershell-scripting/embed.html"><meta property="og:site_name" content="CIS 527 Textbook"><meta property="og:title" content="PowerShell Scripting :: CIS 527 Textbook"><meta property="og:description" content="Resources Windows PowerShell: Scripting Crash Course from Microsoft TechNet How to Write and Run Scripts in the Windows PowerShell ISE from Microsoft Windows PowerShell Scripting Tutorial for Beginners from Netwrix Video Transcript This video introduces the Windows PowerShell Integrated Scripting Environment (ISE) and covers the basics for creating and running your own scripts in Windows PowerShell.
Before we begin, we must change one system setting to allow unsigned PowerShell scripts to run."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Extras"><meta property="article:modified_time" content="2021-08-23T10:38:52-05:00"><meta itemprop=name content="PowerShell Scripting :: CIS 527 Textbook"><meta itemprop=description content="Resources Windows PowerShell: Scripting Crash Course from Microsoft TechNet How to Write and Run Scripts in the Windows PowerShell ISE from Microsoft Windows PowerShell Scripting Tutorial for Beginners from Netwrix Video Transcript This video introduces the Windows PowerShell Integrated Scripting Environment (ISE) and covers the basics for creating and running your own scripts in Windows PowerShell.
Before we begin, we must change one system setting to allow unsigned PowerShell scripts to run."><meta itemprop=dateModified content="2021-08-23T10:38:52-05:00"><meta itemprop=wordCount content="1104"><title>PowerShell Scripting :: CIS 527 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis527/x-extras/05-powershell-scripting/ rel=canonical type=text/html title="PowerShell Scripting :: CIS 527 Textbook"><link href=/cis527/x-extras/05-powershell-scripting/index.xml rel=alternate type=application/rss+xml title="PowerShell Scripting :: CIS 527 Textbook"><link href=/cis527/x-extras/05-powershell-scripting/index.print.html rel=alternate type=text/html title="PowerShell Scripting :: CIS 527 Textbook"><link href=/cis527/x-extras/05-powershell-scripting/tele.html rel=alternate type=text/html title="PowerShell Scripting :: CIS 527 Textbook"><link href=/cis527/css/fontawesome-all.min.css?1723835251 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fontawesome-all.min.css?1723835251 rel=stylesheet></noscript><link href=/cis527/css/nucleus.css?1723835251 rel=stylesheet><link href=/cis527/css/auto-complete.css?1723835251 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/auto-complete.css?1723835251 rel=stylesheet></noscript><link href=/cis527/css/perfect-scrollbar.min.css?1723835251 rel=stylesheet><link href=/cis527/css/fonts.css?1723835251 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fonts.css?1723835251 rel=stylesheet></noscript><link href=/cis527/css/theme.css?1723835251 rel=stylesheet><link href=/cis527/css/theme-light-theme.css?1723835251 rel=stylesheet id=R-variant-style><link href=/cis527/css/chroma-relearn-light.css?1723835251 rel=stylesheet id=R-variant-chroma-style><link href=/cis527/css/variant.css?1723835251 rel=stylesheet><link href=/cis527/css/print.css?1723835251 rel=stylesheet media=print><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis527",window.index_js_url="/cis527/index.search.js",window.variants&&variants.init(["light-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis527/css/custom.css?1723835251 rel=stylesheet></head><body class="mobile-support embed disableInlineCopyToClipboard" data-url=/cis527/x-extras/05-powershell-scripting/embed.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/j8vDSs2mDeM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h4 id=resources>Resources</h4><ul><li><a href=https://technet.microsoft.com/en-us/library/hh551144.aspx rel=external target=_blank>Windows PowerShell: Scripting Crash Course</a> from Microsoft TechNet</li><li><a href="https://docs.microsoft.com/en-us/powershell/scripting/core-powershell/ise/how-to-write-and-run-scripts-in-the-windows-powershell-ise?view=powershell-6" rel=external target=_blank>How to Write and Run Scripts in the Windows PowerShell ISE</a> from Microsoft</li><li><a href=https://blog.netwrix.com/2018/02/21/windows-powershell-scripting-tutorial-for-beginners/ rel=external target=_blank>Windows PowerShell Scripting Tutorial for Beginners</a> from Netwrix</li></ul><h4 id=video-transcript>Video Transcript</h4><p>This video introduces the Windows PowerShell Integrated Scripting Environment (ISE) and covers the basics for creating and running your own scripts in Windows PowerShell.</p><p>Before we begin, we must change one system setting to allow unsigned PowerShell scripts to run. To do this, you&rsquo;ll need to open a PowerShell window using the Run as Administrator option, and then enter the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Set-ExecutionPolicy</span> <span class=n>Unrestricted</span></span></span></code></pre></div><p>However, be aware that this makes your system a bit more vulnerable. If you or a malicious program tries to run a malicious PowerShell script that is unsigned, the system will not try to stop you. It would be a very rare occurrence, but it is something to be aware of.</p><p>Now, let&rsquo;s open the PowerShell ISE to start writing scripts. To find it, simply search for PowerShell ISE on your Start Menu. It should be included by default on all versions of Windows 10.</p><p>When you first open the PowerShell ISE, you may have to click the Script button in the upper-right corner of the window to view both the scripting pane and the command window. To write your scripts, you can simply write the text in the upper window, then save the file and run the program using the Run script button on the top toolbar. You can also run the script in the command window below.</p><p>To begin, let&rsquo;s take a look at a simple Hello World script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Hello World&#34;</span>
</span></span><span class=line><span class=cl><span class=k>return</span></span></span></code></pre></div><p>This script should be pretty self-explanatory. The <code>Write-Host</code> command simply displays text on the terminal, and the return line ends the script. As with any programming language, it is good practice to include a return at the end of your script, but it is not necessarily required.</p><p>Let&rsquo;s look at a more advanced script to see more features of the Windows PowerShell scripting language.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>Param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$user</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=o>-not</span> <span class=p>(</span><span class=nv>$user</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Usage: batman.ps1 &lt;name&gt;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>.</span><span class=py>CompareTo</span><span class=p>(</span><span class=s2>&#34;Batman&#34;</span><span class=p>)</span> <span class=o>-eq</span> <span class=mf>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Hello Mr. Wayne&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>.</span><span class=py>CompareTo</span><span class=p>(</span><span class=s2>&#34;Robin&#34;</span><span class=p>)</span> <span class=o>-eq</span> <span class=mf>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;Welcome back Mr. Grayson&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;Intruder alert!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span></span></span></code></pre></div><p>At the top of this script, there is a special <code>Param</code> section. In PowerShell, any parameters expected from the user must be declared here, with the data type in square brackets (<code>[</code> and <code>]</code>), followed by the variable name prefixed with a dollar sign <code>$</code>. In this script, we have declared one command line parameter <code>$user</code> of type string.</p><p>Below that, we have the first if statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=o>-not</span> <span class=p>(</span><span class=nv>$user</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Usage: batman.ps1 &lt;name&gt;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This will check to see if the <code>$user</code> parameter was provided. If it was not, it will print an error message and return to end the script.</p><p>The next if statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>.</span><span class=py>CompareTo</span><span class=p>(</span><span class=s2>&#34;Batman&#34;</span><span class=p>)</span> <span class=o>-eq</span> <span class=mf>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Hello Mr. Wayne&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>.</span><span class=py>CompareTo</span><span class=p>(</span><span class=s2>&#34;Robin&#34;</span><span class=p>)</span> <span class=o>-eq</span> <span class=mf>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;Welcome back Mr. Grayson&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;Intruder alert!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>performs a string comparison between the <code>$user</code> parameter and the string &ldquo;Batman&rdquo;, if the comparison returns <code>0</code>, they are equal. This is very similar to other string comparison functions in C# and Java. One interesting item to note here is the use of <code>-eq</code> to denote equality. For some reason, PowerShell uses short textual comparison operators instead of the common symbols for boolean comparisons. I really don&rsquo;t know why that particular design decision was made, but I encourage you to look at the documentation to see what options are available for comparison.</p><p>Here is another simple script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>Param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$path</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$files</span> <span class=p>=</span> <span class=nb>Get-ChildItem</span> <span class=nv>$path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$file</span> <span class=k>in</span> <span class=nv>$files</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=nv>$file</span><span class=p>.</span><span class=py>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This is an example of a simple looping script. In this script, it will get a path from the user as an argument, then store a list of all the child items on that path in <code>$files</code> variable. Then, it will use a &ldquo;foreach&rdquo; loop to print out the name of each of those files. Thankfully, if you&rsquo;ve done any programming in the .NET family of languages, most of this syntax will be very familiar to you.</p><p>You can also use PowerShell to create a simple menu for your script. This is a bit more involved than the example from the Linux Bash scripting video, but it is pretty straightforward:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$title</span> <span class=p>=</span> <span class=s2>&#34;Select Options&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$message</span> <span class=p>=</span> <span class=s2>&#34;Choose an option to perform&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$build</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Management</span><span class=p>.</span><span class=py>Automation</span><span class=p>.</span><span class=py>Host</span><span class=p>.</span><span class=py>ChoiceDescription</span> <span class=s2>&#34;&amp;Build&#34;</span><span class=p>,</span> <span class=s2>&#34;Build the project&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$run</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Management</span><span class=p>.</span><span class=py>Automation</span><span class=p>.</span><span class=py>Host</span><span class=p>.</span><span class=py>ChoiceDescription</span> <span class=s2>&#34;&amp;Run&#34;</span><span class=p>,</span> <span class=s2>&#34;Run the project&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$clean</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Management</span><span class=p>.</span><span class=py>Automation</span><span class=p>.</span><span class=py>Host</span><span class=p>.</span><span class=py>ChoiceDescription</span> <span class=s2>&#34;&amp;Clean&#34;</span><span class=p>,</span> <span class=s2>&#34;Clean the project&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$quit</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Management</span><span class=p>.</span><span class=py>Automation</span><span class=p>.</span><span class=py>Host</span><span class=p>.</span><span class=py>ChoiceDescription</span> <span class=s2>&#34;&amp;Quit&#34;</span><span class=p>,</span> <span class=s2>&#34;Quit&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$options</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Management.Automation.Host.ChoiceDescription[]</span><span class=p>](</span><span class=nv>$build</span><span class=p>,</span> <span class=nv>$run</span><span class=p>,</span> <span class=nv>$clean</span><span class=p>,</span> <span class=nv>$quit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=p>=</span> <span class=nv>$host</span><span class=p>.</span><span class=py>ui</span><span class=p>.</span><span class=py>PromptForChoice</span><span class=p>(</span><span class=nv>$title</span><span class=p>,</span> <span class=nv>$message</span><span class=p>,</span> <span class=nv>$options</span><span class=p>,</span> <span class=mf>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>switch</span> <span class=p>(</span><span class=nv>$result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mf>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;You selected Build&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=mf>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;You selected Run&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=mf>2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;You selected Clean&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=mf>3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;You selected Quit&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>At the top of the script, the first two variables define the text that will be shown as the title of the menu and the message displayed to the user before the menu options. The next four variables define the menu choices available. Looking at the first one, the <code>&amp;Build</code> gives the title of the option, with the ampersand <code>&</code> before the &lsquo;B&rsquo; indicating which letter should be the shortcut to choose that option. The next string gives a longer description of the option. Finally, we put it all together in the <code>$options</code> variable as an array of available options, then use the PromptForChoice function to display the menu to the user, storing the user&rsquo;s choice in the <code>$result</code> variable. Finally, we use a simple &ldquo;switch&rdquo; statement to determine which option the user chose and then perform that task.</p><p>If you are having trouble understanding what each part does, I recommend just running the script once and then matching up the text displayed in the menu with the script&rsquo;s code. It may seem a bit daunting at first, but it is actually pretty simple overall. As a quick aside, if you run this on a system with a GUI, you may get an actual pop-up menu instead of a textual menu, but rest assured that it will display the textual version on system&rsquo;s without a GUI.</p><p>Finally, here is a quick script demonstrating how to get user input directly within the script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$name</span> <span class=p>=</span> <span class=nb>Read-Host</span> <span class=s2>&#34;Input your name and press [ENTER]&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Welcome </span><span class=nv>$name</span><span class=s2>!&#34;</span></span></span></code></pre></div><p>It&rsquo;s as simple as that! Of course, that is just a very small taste of what PowerShell is capable of. Hopefully this introduction gives you some idea of what is available, but I encourage you to consult the online documentation for PowerShell to learn even more about it.</p><footer class=footline></footer></article></div></main></div><script src=/cis527/js/clipboard.min.js?1723835251 defer></script><script src=/cis527/js/perfect-scrollbar.min.js?1723835251 defer></script><script src=/cis527/js/theme.js?1723835251 defer></script><script src=/cis527/js/embed-iframe.js?1723835251 defer></script></body></html>