<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=generator content="Relearn 8.0.0"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content='CIS 527
Lab 5.A - Reverse Proxy
Image Source: Linux Handbook
Option 1 - Nginxservices:nginx:image: nginx:alpinecontainer_name: proxyports:- "8080:80"volumes:- /home/cis527/docker/proxy:/etc/nginx/templates:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalwhoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalnetworks:internal:internal: trueOption 1 - Nginx# /home/cis527/docker/proxy/default.conf.templateserver {listen 80;server_name one.local;location / {proxy_pass http://whoami1:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}server {listen 80;server_name two.local;location / {proxy_pass http://whoami2:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}Option 1 - NginxOption 2 - Nginx Proxyservices:proxy:image: jwilder/nginx-proxy:latestcontainer_name: proxyports:- "8080:80"volumes:# Security Concern!- /var/run/docker.sock:/tmp/docker.sock:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalenvironment:- VIRTUAL_HOST=one.local- VIRTUAL_PORT=8000whoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalenvironment:- VIRTUAL_HOST=two.local- VIRTUAL_PORT=8000networks:internal:internal: trueOption 2 - Nginx ProxySecurity ConcernUses Docker SocketAllows Detection of Containersroot in container = root on hostSecure using TLSProtect via proxyDon&#39;t expose to internet!Option 3 - Traefik ProxyImage Source: Traefik'><meta name=author content="Russell Feldhausen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><meta name=twitter:description content='CIS 527
Lab 5.A - Reverse Proxy
Image Source: Linux Handbook
Option 1 - Nginxservices:nginx:image: nginx:alpinecontainer_name: proxyports:- "8080:80"volumes:- /home/cis527/docker/proxy:/etc/nginx/templates:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalwhoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalnetworks:internal:internal: trueOption 1 - Nginx# /home/cis527/docker/proxy/default.conf.templateserver {listen 80;server_name one.local;location / {proxy_pass http://whoami1:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}server {listen 80;server_name two.local;location / {proxy_pass http://whoami2:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}Option 1 - NginxOption 2 - Nginx Proxyservices:proxy:image: jwilder/nginx-proxy:latestcontainer_name: proxyports:- "8080:80"volumes:# Security Concern!- /var/run/docker.sock:/tmp/docker.sock:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalenvironment:- VIRTUAL_HOST=one.local- VIRTUAL_PORT=8000whoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalenvironment:- VIRTUAL_HOST=two.local- VIRTUAL_PORT=8000networks:internal:internal: trueOption 2 - Nginx ProxySecurity ConcernUses Docker SocketAllows Detection of Containersroot in container = root on hostSecure using TLSProtect via proxyDon&#39;t expose to internet!Option 3 - Traefik ProxyImage Source: Traefik'><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis527/5a-containers/08-reverse-proxy-slides/index.html"><meta property="og:site_name" content="CIS 527 Textbook"><meta property="og:description" content='CIS 527
Lab 5.A - Reverse Proxy
Image Source: Linux Handbook
Option 1 - Nginxservices:nginx:image: nginx:alpinecontainer_name: proxyports:- "8080:80"volumes:- /home/cis527/docker/proxy:/etc/nginx/templates:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalwhoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalnetworks:internal:internal: trueOption 1 - Nginx# /home/cis527/docker/proxy/default.conf.templateserver {listen 80;server_name one.local;location / {proxy_pass http://whoami1:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}server {listen 80;server_name two.local;location / {proxy_pass http://whoami2:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}Option 1 - NginxOption 2 - Nginx Proxyservices:proxy:image: jwilder/nginx-proxy:latestcontainer_name: proxyports:- "8080:80"volumes:# Security Concern!- /var/run/docker.sock:/tmp/docker.sock:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalenvironment:- VIRTUAL_HOST=one.local- VIRTUAL_PORT=8000whoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalenvironment:- VIRTUAL_HOST=two.local- VIRTUAL_PORT=8000networks:internal:internal: trueOption 2 - Nginx ProxySecurity ConcernUses Docker SocketAllows Detection of Containersroot in container = root on hostSecure using TLSProtect via proxyDon&#39;t expose to internet!Option 3 - Traefik ProxyImage Source: Traefik'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Containers"><meta property="article:modified_time" content="2024-06-27T15:05:08-05:00"><meta property="og:image" content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><meta itemprop=description content='CIS 527
Lab 5.A - Reverse Proxy
Image Source: Linux Handbook
Option 1 - Nginxservices:nginx:image: nginx:alpinecontainer_name: proxyports:- "8080:80"volumes:- /home/cis527/docker/proxy:/etc/nginx/templates:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalwhoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalnetworks:internal:internal: trueOption 1 - Nginx# /home/cis527/docker/proxy/default.conf.templateserver {listen 80;server_name one.local;location / {proxy_pass http://whoami1:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}server {listen 80;server_name two.local;location / {proxy_pass http://whoami2:8000;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;proxy_set_header X-Forwarded-Proto $scheme;proxy_buffering off;proxy_request_buffering off;proxy_http_version 1.1;proxy_intercept_errors on;}}Option 1 - NginxOption 2 - Nginx Proxyservices:proxy:image: jwilder/nginx-proxy:latestcontainer_name: proxyports:- "8080:80"volumes:# Security Concern!- /var/run/docker.sock:/tmp/docker.sock:ronetworks:- default- internalwhoami1:image: jwilder/whoamicontainer_name: whoami1networks:- internalenvironment:- VIRTUAL_HOST=one.local- VIRTUAL_PORT=8000whoami2:image: jwilder/whoamicontainer_name: whoami2networks:- internalenvironment:- VIRTUAL_HOST=two.local- VIRTUAL_PORT=8000networks:internal:internal: trueOption 2 - Nginx ProxySecurity ConcernUses Docker SocketAllows Detection of Containersroot in container = root on hostSecure using TLSProtect via proxyDon&#39;t expose to internet!Option 3 - Traefik ProxyImage Source: Traefik'><meta itemprop=dateModified content="2024-06-27T15:05:08-05:00"><meta itemprop=wordCount content="309"><meta itemprop=image content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><title></title><link href=https://textbooks.cs.ksu.edu/cis527/5a-containers/08-reverse-proxy-slides/index.html rel=canonical type=text/html title><link href=/cis527/5a-containers/08-reverse-proxy-slides/index.xml rel=alternate type=application/rss+xml title><link href=/cis527/5a-containers/08-reverse-proxy-slides/index.print.html rel=alternate type=text/html title><link href=/cis527/5a-containers/08-reverse-proxy-slides/embed.html rel=alternate type=text/html title><link href=/cis527/css/auto-complete/auto-complete.min.css?1760473528 rel=stylesheet><script src=/cis527/js/auto-complete/auto-complete.min.js?1760473528 defer></script><script src=/cis527/js/search-lunr.min.js?1760473528 defer></script><script src=/cis527/js/search.min.js?1760473528 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/cis527/searchindex.en.js?1760473528"</script><script src=/cis527/js/lunr/lunr.min.js?1760473528 defer></script><script src=/cis527/js/lunr/lunr.stemmer.support.min.js?1760473528 defer></script><script src=/cis527/js/lunr/lunr.multi.min.js?1760473528 defer></script><script src=/cis527/js/lunr/lunr.en.min.js?1760473528 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/cis527/fonts/fontawesome/css/fontawesome-all.min.css?1760473528 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/fonts/fontawesome/css/fontawesome-all.min.css?1760473528 rel=stylesheet></noscript><link href=/cis527/css/perfect-scrollbar/perfect-scrollbar.min.css?1760473528 rel=stylesheet><link href=/cis527/css/theme.min.css?1760473528 rel=stylesheet><link href=/cis527/css/format-html.min.css?1760473528 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/5a-containers/08-reverse-proxy-slides/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis527",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!1,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["light-theme"],window.relearn.customvariantname="my-custom-variant",window.relearn.writeVariant=!1,window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.writeVariant&&window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=/cis527/css/custom.css?1760473528 rel=stylesheet></head><body class="mobile-support html" data-url=/cis527/5a-containers/08-reverse-proxy-slides/index.html><div id=tele class="tele mirror"><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable reveal" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1></h1><section><h2>CIS 527</h2><br><br><p>Lab 5.A - Reverse Proxy</p></section><section><img class="stretch plain" src=/cis527/images/5a/reverse-proxy.webp><p class=imagecredit>Image Source: <a href=https://linuxhandbook.com/nginx-reverse-proxy-docker/>Linux Handbook</a></p></section><section><h3>Option 1 - Nginx</h3><pre class=stretch><code class=yml style=font-size:30px;line-height:34px>services:
  nginx:
    image: nginx:alpine
    container_name: proxy
    ports:
      - "8080:80"
    volumes:
      - /home/cis527/docker/proxy:/etc/nginx/templates:ro
    networks:
      - default
      - internal
  whoami1:
    image: jwilder/whoami
    container_name: whoami1
    networks:
      - internal
  whoami2:
    image: jwilder/whoami
    container_name: whoami2
    networks:
      - internal
networks:
  internal:
    internal: true</code></pre></section><section><h3>Option 1 - Nginx</h3><pre class=stretch><code class=nginx style=font-size:25px;line-height:28px># /home/cis527/docker/proxy/default.conf.template
server {
    listen 80;
    server_name one.local;
    location / {
        proxy_pass http://whoami1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_buffering off;
        proxy_request_buffering off;
        proxy_http_version 1.1;
        proxy_intercept_errors on;
    }
}
server {
    listen 80;
    server_name two.local;
    location / {
        proxy_pass http://whoami2:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_buffering off;
        proxy_request_buffering off;
        proxy_http_version 1.1;
        proxy_intercept_errors on;
    }
}</code></pre></section><section><h3>Option 1 - Nginx</h3><img class="stretch plain" src=/cis527/images/5a/proxy1.png></section><section><h3>Option 2 - Nginx Proxy</h3><pre class=stretch><code class=yml style=font-size:25px;line-height:27px>services:
  proxy:
    image: jwilder/nginx-proxy:latest
    container_name: proxy
    ports:
      - "8080:80"
    volumes:
      # Security Concern!
      - /var/run/docker.sock:/tmp/docker.sock:ro
    networks:
      - default
      - internal
  whoami1:
    image: jwilder/whoami
    container_name: whoami1
    networks:
      - internal
    environment:
      - VIRTUAL_HOST=one.local
      - VIRTUAL_PORT=8000
  whoami2:
    image: jwilder/whoami
    container_name: whoami2
    networks:
      - internal
    environment:
      - VIRTUAL_HOST=two.local
      - VIRTUAL_PORT=8000
networks:
  internal:
    internal: true</code></pre></section><section><h3>Option 2 - Nginx Proxy</h3><img class="stretch plain" src=/cis527/images/5a/proxy2.png></section><section><h3>Security Concern</h3><ul><li>Uses Docker Socket</li><li>Allows Detection of Containers</li><li>root in container = root on host</li><li>Secure using TLS</li><li>Protect via proxy</li><li><i>Don't expose to internet!</i></li></ul></section><section><h3>Option 3 - Traefik Proxy</h3><img class="stretch plain" src=/cis527/images/5a/traefik-logo.svg><p class=imagecredit>Image Source: <a href=https://doc.traefik.io/traefik/>Traefik</a></p></section><section><h3>Option 3 - Traefik Proxy</h3><pre class=stretch><code class=yml style=font-size:24px;line-height:26px>services:
  proxy:
    image: traefik:v2.7
    container_name: proxy
    command: --api.insecure=true --providers.docker
    ports:
      - "8080:80"       # proxy
      - "8081:8080"     # web dashboard
    volumes:
      # Security Concern!
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - default
      - internal
  whoami1:
    image: jwilder/whoami
    container_name: whoami1
    networks:
      - internal
    labels:
      - "traefik.http.routers.whoami1.rule=Host(`one.local`)"
      - "traefik.http.services.whoami1.loadbalancer.server.port=8000"
  whoami2:
    image: jwilder/whoami
    container_name: whoami2
    networks:
      - internal
    labels:
      - "traefik.http.routers.whoami2.rule=Host(`two.local`)"
      - "traefik.http.services.whoami2.loadbalancer.server.port=8000"
networks:
  internal:
    internal: true</code></pre></section><section><h3>Option 3 - Traefik Proxy</h3><img class="stretch plain" src=/cis527/images/5a/proxy3.png></img></section><section><h3>Option 3 - Traefik Proxy</h3><img class="stretch plain" src=/cis527/images/5a/traefik-dashboard.png></img></section><section><h3>Summary</h3><ul><li>Nginx</li><li>Nginx Proxy</li><li>Traefik</li><li><i>Many Others</i></li></ul><p><i>Kubernetes handles this for you</i></p></section><footer class=footline></footer></article></div></main></div><script src=/cis527/js/clipboard/clipboard.min.js?1760473528 defer></script><script src=/cis527/js/perfect-scrollbar/perfect-scrollbar.min.js?1760473528 defer></script><script src=/cis527/js/theme.min.js?1760473528 defer></script></div><script src=/cis527/js/tele-scroll.min.js?1760473528 defer></script></body></html>