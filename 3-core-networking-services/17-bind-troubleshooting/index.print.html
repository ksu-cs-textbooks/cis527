<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=generator content="Relearn 8.0.0"><meta name=description content="As I was reworking this lab for the Summer 2020 semester, I ran into a few issues getting my own bind9 server to work. In doing so, I ended up taking some great screenshots of common misconfigurations of bind9 and the related output from using the dig command to diagnose the issue. I figured it would be helpful to share those screenshots here to give you a nice guide to some common errors you may encounter when working with bind9."><meta name=author content="Russell Feldhausen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><meta name=twitter:title content="Bind Troubleshooting :: CIS 527 Textbook"><meta name=twitter:description content="As I was reworking this lab for the Summer 2020 semester, I ran into a few issues getting my own bind9 server to work. In doing so, I ended up taking some great screenshots of common misconfigurations of bind9 and the related output from using the dig command to diagnose the issue. I figured it would be helpful to share those screenshots here to give you a nice guide to some common errors you may encounter when working with bind9."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis527/3-core-networking-services/17-bind-troubleshooting/index.html"><meta property="og:site_name" content="CIS 527 Textbook"><meta property="og:title" content="Bind Troubleshooting :: CIS 527 Textbook"><meta property="og:description" content="As I was reworking this lab for the Summer 2020 semester, I ran into a few issues getting my own bind9 server to work. In doing so, I ended up taking some great screenshots of common misconfigurations of bind9 and the related output from using the dig command to diagnose the issue. I figured it would be helpful to share those screenshots here to give you a nice guide to some common errors you may encounter when working with bind9."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Core Networking Services"><meta property="article:modified_time" content="2024-09-26T09:59:30-05:00"><meta property="og:image" content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><meta itemprop=name content="Bind Troubleshooting :: CIS 527 Textbook"><meta itemprop=description content="As I was reworking this lab for the Summer 2020 semester, I ran into a few issues getting my own bind9 server to work. In doing so, I ended up taking some great screenshots of common misconfigurations of bind9 and the related output from using the dig command to diagnose the issue. I figured it would be helpful to share those screenshots here to give you a nice guide to some common errors you may encounter when working with bind9."><meta itemprop=dateModified content="2024-09-26T09:59:30-05:00"><meta itemprop=wordCount content="807"><meta itemprop=image content="https://textbooks.cs.ksu.edu/cis527/images/hero.png"><title>Bind Troubleshooting :: CIS 527 Textbook</title><link href=https://textbooks.cs.ksu.edu/cis527/3-core-networking-services/17-bind-troubleshooting/index.html rel=canonical type=text/html title="Bind Troubleshooting :: CIS 527 Textbook"><link href=/cis527/3-core-networking-services/17-bind-troubleshooting/index.xml rel=alternate type=application/rss+xml title="Bind Troubleshooting :: CIS 527 Textbook"><link href=/cis527/3-core-networking-services/17-bind-troubleshooting/tele.html rel=alternate type=text/html title="Bind Troubleshooting :: CIS 527 Textbook"><link href=/cis527/3-core-networking-services/17-bind-troubleshooting/embed.html rel=alternate type=text/html title="Bind Troubleshooting :: CIS 527 Textbook"><link href=/cis527/css/auto-complete/auto-complete.min.css?1758639113 rel=stylesheet><script src=/cis527/js/auto-complete/auto-complete.min.js?1758639113 defer></script><script src=/cis527/js/search-lunr.min.js?1758639113 defer></script><script src=/cis527/js/search.min.js?1758639113 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/cis527/searchindex.en.js?1758639113"</script><script src=/cis527/js/lunr/lunr.min.js?1758639113 defer></script><script src=/cis527/js/lunr/lunr.stemmer.support.min.js?1758639113 defer></script><script src=/cis527/js/lunr/lunr.multi.min.js?1758639113 defer></script><script src=/cis527/js/lunr/lunr.en.min.js?1758639113 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/cis527/fonts/fontawesome/css/fontawesome-all.min.css?1758639113 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/fonts/fontawesome/css/fontawesome-all.min.css?1758639113 rel=stylesheet></noscript><link href=/cis527/css/perfect-scrollbar/perfect-scrollbar.min.css?1758639113 rel=stylesheet><link href=/cis527/css/theme.min.css?1758639113 rel=stylesheet><link href=/cis527/css/format-print.min.css?1758639113 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/3-core-networking-services/17-bind-troubleshooting/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis527",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!1,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["light-theme"],window.relearn.customvariantname="my-custom-variant",window.relearn.writeVariant=!1,window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.writeVariant&&window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=/cis527/css/custom.css?1758639113 rel=stylesheet></head><body class="mobile-support embed print" data-url=/cis527/3-core-networking-services/17-bind-troubleshooting/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable 3-core-networking-services" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=bind-troubleshooting>Bind Troubleshooting</h1><p>As I was reworking this lab for the Summer 2020 semester, I ran into a few issues getting my own bind9 server to work. In doing so, I ended up taking some great screenshots of common misconfigurations of bind9 and the related output from using the <code>dig</code> command to diagnose the issue. I figured it would be helpful to share those screenshots here to give you a nice guide to some common errors you may encounter when working with bind9.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>When using the <code>dig</code> command, you can specify the DNS server it contacts using the <code>@</code> symbol followed by the IP address of the server. For example, if my DNS server is at IP address <code>192.168.40.41</code>, I can use the following command to query it:</p><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>dig @192.168.40.41 ns.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>This can be done from the server with DNS installed, or another system. You <strong>should not</strong> use the localhost address <code>127.0.01</code> for this, since Ubuntu installs a local caching DNS server by default that runs on localhost. The bind9 DNS server is typically only accessible via the external IP address.</p><p>If an address is not specified, <code>dig</code> uses the DNS settings of the operating system. The screenshots below were created on a system that had the DNS configuration updated to point directly at the DNS server created for this lab.</p></div></details><h2 id=incorrect-screenshots>Incorrect Screenshots</h2><h4 id=bad-ptr-response>Bad PTR Response</h4><p><a href=#R-image-5d1ef4a7e3a2aa6cad6755d3cd768605 class=lightbox-link><img alt="192.168.40.41 bad" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-badresponse.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d1ef4a7e3a2aa6cad6755d3cd768605><img alt="192.168.40.41 bad" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-badresponse.png></a></p><p>In this screenshot, I attempted to do a reverse lookup of <code>192.168.40.41</code>, which should resolve to <code>ns.cis527russfeld.cs.ksu.edu</code>. This test was done from the machine with that IP address. Unfortunately, my server was misconfigured, and the reverse zone file was not properly included (the path in my <code>named.conf.local</code> file had a typo, to be exact). Since that file was not availble, my system returned the response from it&rsquo;s local DNS information, showing that the IP address <code>192.168.40.41</code> belongs to <code>cis527U-russfeld.</code>, which is the name of the actual computer and not its name in the DNS system. This can happen if you try to request information about the local system and the DNS server does not contain the correct information.</p><h4 id=no-ptr-response>No PTR Response</h4><p><a href=#R-image-deec08b9f3256dbbccb6db19a733dc9c class=lightbox-link><img alt="192.168.40.42 no response" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-noresponse.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-deec08b9f3256dbbccb6db19a733dc9c><img alt="192.168.40.42 no response" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-noresponse.png></a></p><p>With the same misconfiguration as described above, when I query a different system, such as <code>192.168.40.42</code>, I instead get an empty response as shown here. This is the usual situation if the DNS server is misconfigured and the PTR record cannot be found. If the output of <code>dig</code> is missing an answer section, it usually indicates that the lookup failed.</p><h4 id=missing-period>Missing Period</h4><p><a href=#R-image-dbb77ea6e42e1b71ec4654ba90083a1c class=lightbox-link><img alt="192.168.40.41 no period" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-reversebad1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dbb77ea6e42e1b71ec4654ba90083a1c><img alt="192.168.40.41 no period" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-reversebad1.png></a></p><p>So, I corrected my error and restarted my bind9 server, and once again tried to query one of my reverse lookup addresses. However, in this case, I <em>did</em> get a response from the DNS server, but it was incorrect. The address returned when I queried <code>192.168.40.42</code> as <code>windows.cis527russfeld.cs.ksu.edu.40.168.192.in-addr.arpa</code>, which is not what I wanted. This can happen when you forget to add the <strong>all important period</strong> at the end of an entry in your zone file.</p><p><a href=#R-image-d09e3e702719bdd4a39b2d69f1745e6b class=lightbox-link><img alt=Period class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-period.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d09e3e702719bdd4a39b2d69f1745e6b><img alt=Period class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-period.png></a></p><p>That one, right there. If you forget that one, the bind9 DNS server will automatically append a whole bunch of domain information after the address. Sometimes we want that, but in this case, we don&rsquo;t. So, be <em>very</em> careful and don&rsquo;t forget the periods.</p><h4 id=dns-caching>DNS Caching</h4><p><a href=#R-image-17228d2a564883c78fcaaf94946be54c class=lightbox-link><img alt="192.168.40.41 fail after fix" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-flushcache.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17228d2a564883c78fcaaf94946be54c><img alt="192.168.40.41 fail after fix" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-flushcache.png></a></p><p>In this screenshot, I had just resolved the error above and restarted my bind9 server to load the newly changed files. Then, I once again used <code>dig</code> to query <code>192.168.40.42</code>, expecting to see the correct output. Instead, I still received the incorrect output as seen in the screenshot above. This is a very common problem!</p><p>There can be a couple of causes of this issue. First, whenever you update a zone file, don&rsquo;t forget to change the serial value to a larger number. The DigitalOcean guide just has you start with 2 and go to 3 and so on. I like to use the date, followed by a serial for that day. So, I would use a serial such as <code>202005061</code> for the first update made on May 6th, 2020 (2020-05-06).</p><p>Secondly, even if you remember to do that, many modern systems employ some form of <em>DNS caching</em> that stores the responses from previous queries. Both Ubuntu and Windows do this automatically. So, you may also have to clear your DNS cache to make sure it is properly querying the server. On Ubuntu, use <code>sudo resolvectl flush-caches</code> and on Windows use <code>ipconfig /flush-dns</code>.</p><p><a href=#R-image-70ec3c2d6e96dfd8424ae9adcaab2d70 class=lightbox-link><img alt="192.168.40.41 fail after fix" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-flushcache2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-70ec3c2d6e96dfd8424ae9adcaab2d70><img alt="192.168.40.41 fail after fix" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-flushcache2.png></a></p><p>Immediately after flushing the DNS cache, I was able to perform the query again and get the correct result.</p><h2 id=correct-screenshots>Correct Screenshots</h2><p>Below are screenshots showing correct output for various <code>dig</code> commands. You may use these screenshots to help in your debugging process. To take these screenshots, I updated the static IP address configuration for the Ubuntu Server to use it&rsquo;s own IP address <code>192.168.40.41</code> as the only DNS server.</p><h4 id=correct-a-records>Correct A Records</h4><p><a href=#R-image-d99171316d3d6d2326863c09db52b789 class=lightbox-link><img alt=ns.cis527russfeld.cs.ksu.edu class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-dig1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d99171316d3d6d2326863c09db52b789><img alt=ns.cis527russfeld.cs.ksu.edu class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-dig1.png></a>
<a href=#R-image-46d0b2bc3b2a601cad6c62380996ee72 class=lightbox-link><img alt=windows.cis527russfeld.cs.ksu.edu class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-dig2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-46d0b2bc3b2a601cad6c62380996ee72><img alt=windows.cis527russfeld.cs.ksu.edu class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-dig2.png></a></p><h4 id=correct-cname-records>Correct CNAME Records</h4><p><a href=#R-image-5acc9af462d0476e4f4a7e87c5b4ac9d class=lightbox-link><img alt=ubuntu.cis527russfeld.cs.ksu.edu class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-dig3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5acc9af462d0476e4f4a7e87c5b4ac9d><img alt=ubuntu.cis527russfeld.cs.ksu.edu class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-dig3.png></a></p><h4 id=correct-ptr-record>Correct PTR Record</h4><p><a href=#R-image-6bc1230e5f26a984806fbff7dff290df class=lightbox-link><img alt=192.168.40.41 class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-reverse1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6bc1230e5f26a984806fbff7dff290df><img alt=192.168.40.41 class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-reverse1.png></a></p><h4 id=correct-recursive-lookup-outside-our-dns-server>Correct Recursive Lookup (Outside our DNS Server)</h4><p><a href=#R-image-fb3c1942f644c1888642fd402c6ebecf class=lightbox-link><img alt="Recursive Lookup" class="border lazy lightbox figure-image" loading=lazy src=/cis527/images/lab3-recurse.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb3c1942f644c1888642fd402c6ebecf><img alt="Recursive Lookup" class="border lazy lightbox lightbox-image" loading=lazy src=/cis527/images/lab3-recurse.png></a></p><footer class=footline></footer></article></div></main></div><script src=/cis527/js/clipboard/clipboard.min.js?1758639113 defer></script><script src=/cis527/js/perfect-scrollbar/perfect-scrollbar.min.js?1758639113 defer></script><script src=/cis527/js/theme.min.js?1758639113 defer></script><script src=/cis527/js/embed-iframe.min.js?1758639113 defer></script></body></html>