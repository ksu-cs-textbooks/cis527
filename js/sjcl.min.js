"use strict";var E,F,D,H,G,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};sjcl.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,o,r,s=this.s[0][4],i=this.s[1],n=e.length,a=1;if(4!==n&&6!==n&&8!==n)throw new sjcl.exception.invalid("invalid aes key size");this.b=[o=e.slice(0),r=[]];for(e=n;e<4*n+28;e++)t=o[e-1],(0===e%n||8===n&&4===e%n)&&(t=s[t>>>24]<<24^s[t>>16&255]<<16^s[t>>8&255]<<8^s[t&255],0===e%n&&(t=t<<8^t>>>24^a<<24,a=a<<1^283*(a>>7))),o[e]=o[e-n]^t;for(n=0;e;n++,e--)t=o[n&3?e:e-4],r[n]=4>=e||4>n?t:i[0][s[t>>>24]]^i[1][s[t>>16&255]]^i[2][s[t>>8&255]]^i[3][s[t&255]]},sjcl.cipher.aes.prototype={encrypt:function(e){return t(this,e,0)},decrypt:function(e){return t(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e,t,n,s,o,c,l,a=this.s[0],r=this.s[1],u=a[4],h=r[4],i=[],d=[];for(e=0;256>e;e++)d[(i[e]=e<<1^283*(e>>7))^e]=e;for(n=s=0;!u[n];n^=l||1,s=d[s]||1)for(t=s^s<<1^s<<2^s<<3^s<<4,t=t>>8^t&255^99,u[n]=t,h[t]=n,o=i[e=i[l=i[n]]],c=16843009*o^65537*e^257*l^16843008*n,o=257*i[t]^16843008*t,e=0;4>e;e++)a[e][n]=o=o<<24^o>>>8,r[e][t]=c=c<<24^c>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),r[e]=r[e].slice(0)}};function t(e,t,n){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var s=e.b[n],a=t[0]^s[0],r=t[n?3:1]^s[1],c=t[2]^s[2];t=t[n?1:3]^s[3];var i,f,p,v=s.length/4-2,l=4,g=[0,0,0,0],o=e.s[n];e=o[0];var d=o[1],u=o[2],h=o[3],m=o[4];for(i=0;i<v;i++)o=e[a>>>24]^d[r>>16&255]^u[c>>8&255]^h[t&255]^s[l],p=e[r>>>24]^d[c>>16&255]^u[t>>8&255]^h[a&255]^s[l+1],f=e[c>>>24]^d[t>>16&255]^u[a>>8&255]^h[r&255]^s[l+2],t=e[t>>>24]^d[a>>16&255]^u[r>>8&255]^h[c&255]^s[l+3],l+=4,a=o,r=p,c=f;for(i=0;4>i;i++)g[n?3&-i:i]=m[a>>>24]<<24^m[r>>16&255]<<16^m[c>>8&255]<<8^m[t&255]^s[l++],o=a,a=r,r=c,c=t,t=o;return g}sjcl.bitArray={bitSlice:function(e,t,n){return e=sjcl.bitArray.$(e.slice(t/32),32-(t&31)).slice(1),0[0]===n?e:sjcl.bitArray.clamp(e,n-t)},extract:function(e,t,n){var s=Math.floor(-t-n&31);return((t+n-1^t)&-32?e[t/32|0]<<32-s^e[t/32+1|0]>>>s:e[t/32|0]>>>s)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],s=sjcl.bitArray.getPartial(n);return 32===s?e.concat(t):sjcl.bitArray.$(t,s,n|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+sjcl.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;e=e.slice(0,Math.ceil(t/32));var n=e.length;return t=t&31,0<n&&t&&(e[n-1]=sjcl.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?t|0:t<<32-e)+0x10000000000*e},getPartial:function(e){return Math.round(e/0x10000000000)||32},equal:function(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return!1;var n,s=0;for(n=0;n<e.length;n++)s|=e[n]^t[n];return 0===s},$:function(e,t,n,s){var o=0;for(0[0]===s&&(s=[]);32<=t;t-=32)s.push(n),n=0;if(0===t)return s.concat(e);for(o=0;o<e.length;o++)s.push(n|e[o]>>>t),n=e[o]<<32-t;return o=e.length?e[e.length-1]:0,e=sjcl.bitArray.getPartial(o),s.push(sjcl.bitArray.partial(t+e&31,32<t+e?n:s.pop(),1)),s},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(n&65280)<<8|n<<24;return e}},sjcl.codec.utf8String={fromBits:function(e){var t,n,s="",o=sjcl.bitArray.bitLength(e);for(t=0;t<o/8;t++)0===(t&3)&&(n=e[t/4]),s+=String.fromCharCode(n>>>8>>>8>>>8),n<<=8;return decodeURIComponent(escape(s))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,s=[],n=0;for(t=0;t<e.length;t++)n=n<<8|e.charCodeAt(t),3===(t&3)&&(s.push(n),n=0);return t&3&&s.push(sjcl.bitArray.partial(8*(t&3),n)),s}},sjcl.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=((e[t]|0)+0xf00000000000).toString(16).substr(4);return n.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(e){var t,s,n=[];e=e.replace(/\s|0x/g,""),s=e.length,e=e+"00000000";for(t=0;t<e.length;t+=8)n.push(parseInt(e.substr(t,8),16)^0);return sjcl.bitArray.clamp(n,4*s)}},sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,n){var s=sjcl.codec.base32.BASE,r=sjcl.codec.base32.REMAINING,o="",i=0,c=sjcl.codec.base32.B,a=0,l=sjcl.bitArray.bitLength(e);n&&(c=sjcl.codec.base32.X);for(n=0;o.length*s<l;)o+=c.charAt((a^e[n]>>>i)>>>r),i<s?(a=e[n]<<s-i,i+=r,n++):(a<<=s,i-=s);for(;o.length&7&&!t;)o+="=";return o},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var s,o,r=sjcl.codec.base32.BITS,u=sjcl.codec.base32.BASE,c=sjcl.codec.base32.REMAINING,a=[],n=0,l=sjcl.codec.base32.B,i=0,d="base32";t&&(l=sjcl.codec.base32.X,d="base32hex");for(o=0;o<e.length;o++){if(s=l.indexOf(e.charAt(o)),0>s){if(!t)try{return sjcl.codec.base32hex.toBits(e)}catch{}throw new sjcl.exception.invalid("this isn't "+d+"!")}n>c?(n-=c,a.push(i^s>>>n),i=s<<r-n):(n+=u,i^=s<<r-n)}return n&56&&a.push(sjcl.bitArray.partial(n&56,i,1)),a}},sjcl.codec.base32hex={fromBits:function(e,t){return sjcl.codec.base32.fromBits(e,t,1)},toBits:function(e){return sjcl.codec.base32.toBits(e,1)}},sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var s="",o=0,i=sjcl.codec.base64.B,a=0,r=sjcl.bitArray.bitLength(e);n&&(i=i.substr(0,62)+"-_");for(n=0;6*s.length<r;)s+=i.charAt((a^e[n]>>>o)>>>26),6>o?(a=e[n]<<6-o,o+=26,n++):(a<<=6,o-=6);for(;s.length&3&&!t;)s+="=";return s},toBits:function(e,t){e=e.replace(/\s|=/g,"");var s,o,a=[],n=0,r=sjcl.codec.base64.B,i=0;t&&(r=r.substr(0,62)+"-_");for(o=0;o<e.length;o++){if(s=r.indexOf(e.charAt(o)),0>s)throw new sjcl.exception.invalid("this isn't base64!");26<n?(n-=26,a.push(i^s>>>n),i=s<<32-n):(n+=6,i^=s<<32-n)}return n&56&&a.push(sjcl.bitArray.partial(n&56,i,1)),a}},sjcl.codec.base64url={fromBits:function(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()},sjcl.hash.sha256.hash=function(e){return(new sjcl.hash.sha256).update(e).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){if("string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),n=this.A=sjcl.bitArray.concat(this.A,e),t=this.l,e=this.l=t+sjcl.bitArray.bitLength(e),0x1fffffffffffff<e)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var t,n,o=new Uint32Array(n),s=0;for(t=512+t-(512+t&511);t<=e;t+=512)u(this,o.subarray(16*s,16*(s+1))),s+=1;n.splice(0,16*s)}else for(t=512+t-(512+t&511);t<=e;t+=512)u(this,n.splice(0,16));return this},finalize:function(){var t,e=this.A,n=this.F,e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]);for(t=e.length+2;t&15;t++)e.push(0);e.push(Math.floor(this.l/4294967296));for(e.push(this.l|0);e.length;)u(this,e.splice(0,16));return this.reset(),n},Y:[],b:[],O:function(){function o(e){return 4294967296*(e-Math.floor(e))|0}for(var n,s,e=0,t=2;64>e;t++){s=!0;for(n=2;n*n<=t;n++)if(0===t%n){s=!1;break}s&&(8>e&&(this.Y[e]=o(t**.5)),this.b[e]=o(t**(1/3)),e++)}}};function u(e,t){var s,i,r,n=e.F,f=e.b,h=n[0],o=n[1],c=n[2],d=n[3],a=n[4],u=n[5],l=n[6],m=n[7];for(i=0;64>i;i++)16>i?s=t[i]:(s=t[i+1&15],r=t[i+14&15],s=t[i&15]=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[i&15]+t[i+9&15]|0),s=s+m+(a>>>6^a>>>11^a>>>25^a<<26^a<<21^a<<7)+(l^a&(u^l))+f[i],m=l,l=u,u=a,a=d+s|0,d=c,c=o,o=h,h=s+(o&c^d&(o^c))+(o>>>2^o>>>13^o>>>22^o<<30^o<<19^o<<10)|0;n[0]=n[0]+h|0,n[1]=n[1]+o|0,n[2]=n[2]+c|0,n[3]=n[3]+d|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+m|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(e){sjcl.mode.ccm.G.push(e)},unListenProgress:function(e){e=sjcl.mode.ccm.G.indexOf(e),-1<e&&sjcl.mode.ccm.G.splice(e,1)},fa:function(e){var t,n=sjcl.mode.ccm.G.slice();for(t=0;t<n.length;t+=1)n[t](e)},encrypt:function(e,t,n,s,o){var i,a=t.slice(0),r=sjcl.bitArray,c=r.bitLength(n)/8,l=r.bitLength(a)/8;if(o=o||64,s=s||[],7>c)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;4>i&&l>>>8*i;i++);return i<15-c&&(i=15-c),n=r.clamp(n,8*(15-i)),t=sjcl.mode.ccm.V(e,t,n,s,o,i),a=sjcl.mode.ccm.C(e,a,n,t,o,i),r.concat(a.data,a.tag)},decrypt:function(e,t,n,s,o){o=o||64,s=s||[];var i=sjcl.bitArray,c=i.bitLength(n)/8,a=i.bitLength(t),r=i.clamp(t,a-o),l=i.bitSlice(t,a-o),a=(a-o)/8;if(7>c)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&a>>>8*t;t++);if(t<15-c&&(t=15-c),n=i.clamp(n,8*(15-t)),r=sjcl.mode.ccm.C(e,r,n,l,o,t),e=sjcl.mode.ccm.V(e,r.data,n,s,o,t),!i.equal(r.tag,e))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return r.data},na:function(e,t,n,s,o,i){var r=[],a=sjcl.bitArray,c=a.i;if(s=[a.partial(8,(t.length?64:0)|s-2<<2|i-1)],s=a.concat(s,n),s[3]|=o,s=e.encrypt(s),t.length)for(n=a.bitLength(t)/8,65279>=n?r=[a.partial(16,n)]:4294967295>=n&&(r=a.concat([a.partial(16,65534)],[n])),r=a.concat(r,t),t=0;t<r.length;t+=4)s=e.encrypt(c(s,r.slice(t,t+4).concat([0,0,0])));return s},V:function(e,t,n,s,o,i){var a=sjcl.bitArray,r=a.i;if(o/=8,o%2||4>o||16<o)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<s.length||4294967295<t.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");n=sjcl.mode.ccm.na(e,s,n,o,a.bitLength(t)/8,i);for(s=0;s<t.length;s+=4)n=e.encrypt(r(n,t.slice(s,s+4).concat([0,0,0])));return a.clamp(n,8*o)},C:function(e,t,n,s,o,i){var a,r=sjcl.bitArray,a=r.i,c=t.length,d=r.bitLength(t),l=c/50,u=l;if(n=r.concat([r.partial(8,i-1)],n).concat([0,0,0]).slice(0,4),s=r.bitSlice(a(s,e.encrypt(n)),0,o),!c)return{tag:s,data:[]};for(a=0;a<c;a+=4)a>l&&(sjcl.mode.ccm.fa(a/c),l+=u),n[3]++,o=e.encrypt(n),t[a]^=o[0],t[a+1]^=o[1],t[a+2]^=o[2],t[a+3]^=o[3];return{tag:s,data:r.clamp(t,d)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(e,t,n,s,o,i){if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var r,l,u,h=sjcl.mode.ocb2.S,d=sjcl.bitArray,a=d.i,c=[0,0,0,0];n=h(e.encrypt(n)),u=[],s=s||[],o=o||64;for(r=0;r+4<t.length;r+=4)l=t.slice(r,r+4),c=a(c,l),u=u.concat(a(n,e.encrypt(a(n,l)))),n=h(n);return l=t.slice(r),t=d.bitLength(l),r=e.encrypt(a(n,[0,0,0,t])),l=d.clamp(a(l.concat([0,0,0]),r),t),c=a(c,a(l.concat([0,0,0]),r)),c=e.encrypt(a(c,a(n,h(n)))),s.length&&(c=a(c,i?s:sjcl.mode.ocb2.pmac(e,s))),u.concat(d.concat(l,d.clamp(c,o)))},decrypt:function(e,t,n,s,o,i){if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("ocb iv must be 128 bits");o=o||64;var c,u,h=sjcl.mode.ocb2.S,d=sjcl.bitArray,a=d.i,r=[0,0,0,0],l=h(e.encrypt(n)),m=sjcl.bitArray.bitLength(t)-o,f=[];s=s||[];for(n=0;n+4<m/32;n+=4)c=a(l,e.decrypt(a(l,t.slice(n,n+4)))),r=a(r,c),f=f.concat(c),l=h(l);if(u=m-32*n,c=e.encrypt(a(l,[0,0,0,u])),c=a(c,d.clamp(t.slice(n),u).concat([0,0,0])),r=a(r,c),r=e.encrypt(a(r,a(l,h(l)))),s.length&&(r=a(r,i?s:sjcl.mode.ocb2.pmac(e,s))),!d.equal(d.clamp(r,o),d.bitSlice(t,m)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return f.concat(d.clamp(c,u))},pmac:function(e,t){var n,i=sjcl.mode.ocb2.S,r=sjcl.bitArray,o=r.i,a=[0,0,0,0],s=e.encrypt([0,0,0,0]),s=o(s,i(i(s)));for(n=0;n+4<t.length;n+=4)s=i(s),a=o(a,e.encrypt(o(s,t.slice(n,n+4))));return n=t.slice(n),128>r.bitLength(n)&&(s=o(s,i(s)),n=r.concat(n,[-2147483648,0,0,0])),a=o(a,n),e.encrypt(o(i(o(s,i(s))),a))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(e,t,n,s,o){var i=t.slice(0);return t=sjcl.bitArray,s=s||[],e=sjcl.mode.gcm.C(!0,e,i,s,n,o||128),t.concat(e.data,e.tag)},decrypt:function(e,t,n,s,o){var i=t.slice(0),a=sjcl.bitArray,r=a.bitLength(i);if(o=o||128,s=s||[],o<=r?(t=a.bitSlice(i,r-o),i=a.bitSlice(i,0,r-o)):(t=i,i=[]),e=sjcl.mode.gcm.C(!1,e,i,s,n,o),!a.equal(e.tag,t))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var n,o,a,r=sjcl.bitArray.i,i=[0,0,0,0],s=t.slice(0);for(o=0;128>o;o++){(n=0!==(e[Math.floor(o/32)]&1<<31-o%32))&&(i=r(i,s)),a=0!==(s[3]&1);for(n=3;0<n;n--)s[n]=s[n]>>>1|(s[n-1]&1)<<31;s[0]>>>=1,a&&(s[0]^=-520093696)}return i},j:function(e,t,n){var s,o=n.length;t=t.slice(0);for(s=0;s<o;s+=4)t[0]^=4294967295&n[s],t[1]^=4294967295&n[s+1],t[2]^=4294967295&n[s+2],t[3]^=4294967295&n[s+3],t=sjcl.mode.gcm.ka(t,e);return t},C:function(e,t,n,s,o,i){var a,c,u,d=sjcl.bitArray,f=n.length,h=d.bitLength(n),m=d.bitLength(s),r=d.bitLength(o),l=t.encrypt([0,0,0,0]);96===r?(o=o.slice(0),o=d.concat(o,[1])):(o=sjcl.mode.gcm.j(l,[0,0,0,0],o),o=sjcl.mode.gcm.j(l,o,[0,0,Math.floor(r/4294967296),r&4294967295])),r=sjcl.mode.gcm.j(l,[0,0,0,0],s),u=o.slice(0),s=r.slice(0),e||(s=sjcl.mode.gcm.j(l,r,n));for(c=0;c<f;c+=4)u[3]++,a=t.encrypt(u),n[c]^=a[0],n[c+1]^=a[1],n[c+2]^=a[2],n[c+3]^=a[3];return n=d.clamp(n,h),e&&(s=sjcl.mode.gcm.j(l,r,n)),e=[Math.floor(m/4294967296),m&4294967295,Math.floor(h/4294967296),h&4294967295],s=sjcl.mode.gcm.j(l,s,e),a=t.encrypt(o),s[0]^=a[0],s[1]^=a[1],s[2]^=a[2],s[3]^=a[3],{tag:d.bitSlice(s,0,i),data:n}}},sjcl.misc.hmac=function(e,t){this.W=t=t||sjcl.hash.sha256;var n,s=[[],[]],o=t.prototype.blockSize/32;this.w=[new t,new t],e.length>o&&(e=t.hash(e));for(n=0;n<o;n++)s[0][n]=e[n]^909522486,s[1][n]=e[n]^1549556828;this.w[0].update(s[0]),this.w[1].update(s[1]),this.R=new t(this.w[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(e){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1},sjcl.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)},sjcl.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e},sjcl.misc.pbkdf2=function(e,t,n,s,o){if(n=n||1e4,0>s||0>n)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),o=o||sjcl.misc.hmac,e=new o(e);var a,r,c,l,i=[],d=sjcl.bitArray;for(l=1;32*i.length<(s||1);l++){o=a=e.encrypt(d.concat(t,[l]));for(c=1;c<n;c++)for(a=e.encrypt(a),r=0;r<a.length;r++)o[r]^=a[r];i=i.concat(o)}return s&&(i=d.clamp(i,s)),i},sjcl.prng=function(e){this.c=[new sjcl.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=0[0],this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80},sjcl.prng.prototype={randomWords:function(e,t){var s,o,i,a=[],n=this.isReady(t);if(n===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),s=[],i=0,this.Z=s[0]=(new Date).valueOf()+this.da;for(o=0;16>o;o++)s.push(4294967296*Math.random()|0);for(o=0;o<this.c.length&&(s=s.concat(this.c[o].finalize()),i+=this.m[o],this.m[o]=0,n||!(this.P&1<<o));o++);this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0)),this.f-=i,i>this.o&&(this.o=i),this.P++,this.b=sjcl.hash.sha256.hash(this.b.concat(s)),this.L=new sjcl.cipher.aes(this.b);for(n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)0===(n+1)%this.ca&&y(this),s=z(this),a.push(s[0],s[1],s[2],s[3]);return y(this),a.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,n){n=n||"user";var s,r=(new Date).valueOf(),o=this.H[n],c=this.isReady(),i=0,a=this.U[n];switch(0[0]===a&&(a=this.U[n]=this.ha++),0[0]===o&&(o=this.H[n]=0),this.H[n]=(this.H[n]+1)%this.c.length,typeof e){case"number":0[0]===t&&(t=1),this.c[o].update([a,this.N++,1,t,r,1,e|0]);break;case"object":if(n=Object.prototype.toString.call(e),"[object Uint32Array]"===n){s=[];for(n=0;n<e.length;n++)s.push(e[n]);e=s}else for("[object Array]"!==n&&(i=1),n=0;n<e.length&&!i;n++)"number"!=typeof e[n]&&(i=1);if(!i){if(0[0]===t)for(n=t=0;n<e.length;n++)for(s=e[n];0<s;)t++,s=s>>>1;this.c[o].update([a,this.N++,2,t,r,e.length].concat(e))}break;case"string":0[0]===t&&(t=e.length),this.c[o].update([a,this.N++,3,t,r,e.length]),this.c[o].update(e);break;default:i=1}if(i)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[o]+=t,this.f+=t,c===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(e){return e=this.T[0[0]!==e?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e?1:this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var n,s,o=this.K[e],i=[];for(n in o)o.hasOwnProperty(n)&&o[n]===t&&i.push(n);for(s=0;s<i.length;s++)n=i[s],delete o[n]},la:function(){C(this,1)},oa:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch{n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),C(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),C(this,0)},ma:function(){C(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;"number"==typeof t&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),C(this,0)}};function A(e,t){var n,s=sjcl.random.K[e],o=[];for(n in s)s.hasOwnProperty(n)&&o.push(s[n]);for(n=0;n<o.length;n++)o[n](t)}function C(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function y(e){e.b=z(e).concat(z(e)),e.L=new sjcl.cipher.aes(e.b)}function z(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function B(e,t){return function(){t.apply(e,arguments)}}sjcl.random=new sjcl.prng(6);a:try{if(G="undefined"!=typeof module&&module.exports){try{H=require("crypto")}catch{H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(F=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(e){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,n,s){n=n||{},s=s||{};var i,a=sjcl.json,o=a.g({iv:sjcl.random.randomWords(4,0)},a.defaults);if(a.g(o,n),n=o.adata,"string"==typeof o.salt&&(o.salt=sjcl.codec.base64.toBits(o.salt)),"string"==typeof o.iv&&(o.iv=sjcl.codec.base64.toBits(o.iv)),!sjcl.mode[o.mode]||!sjcl.cipher[o.cipher]||"string"==typeof e&&100>=o.iter||64!==o.ts&&96!==o.ts&&128!==o.ts||128!==o.ks&&192!==o.ks&&256!==o.ks||2>o.iv.length||4<o.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof e?(i=sjcl.misc.cachedPbkdf2(e,o),e=i.key.slice(0,o.ks/32),o.salt=i.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.publicKey&&(i=e.kem(),o.kemtag=i.tag,e=i.key.slice(0,o.ks/32)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof n&&(o.adata=n=sjcl.codec.utf8String.toBits(n)),i=new sjcl.cipher[o.cipher](e),a.g(s,o),s.key=e,o.ct="ccm"===o.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&t instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(i,t,o.iv,n,o.ts):sjcl.mode[o.mode].encrypt(i,t,o.iv,n,o.ts),o},encrypt:function(){var o=sjcl.json,i=o.ja.apply(o,arguments);return o.encode(i)},ia:function(e,t,n,s){n=n||{},s=s||{};var o,i,a=sjcl.json;if(t=a.g(a.g(a.g({},a.defaults),t),n,!0),o=t.adata,"string"==typeof t.salt&&(t.salt=sjcl.codec.base64.toBits(t.salt)),"string"==typeof t.iv&&(t.iv=sjcl.codec.base64.toBits(t.iv)),!sjcl.mode[t.mode]||!sjcl.cipher[t.cipher]||"string"==typeof e&&100>=t.iter||64!==t.ts&&96!==t.ts&&128!==t.ts||128!==t.ks&&192!==t.ks&&256!==t.ks||!t.iv||2>t.iv.length||4<t.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof e?(i=sjcl.misc.cachedPbkdf2(e,t),e=i.key.slice(0,t.ks/32),t.salt=i.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.secretKey&&(e=e.unkem(sjcl.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),"string"==typeof o&&(o=sjcl.codec.utf8String.toBits(o)),i=new sjcl.cipher[t.cipher](e),o="ccm"===t.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(i,t.ct,t.iv,t.tag,o,t.ts):sjcl.mode[t.mode].decrypt(i,t.ct,t.iv,o,t.ts),a.g(s,t),s.key=e,1===n.raw?o:sjcl.codec.utf8String.fromBits(o)},decrypt:function(e,t,n,s){var o=sjcl.json;return o.ia(e,o.decode(t),n,s)},encode:function(e){var t,n="{",s="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(n+=s+'"'+t+'":',s=",",typeof e[t]){case"number":case"boolean":n+=e[t];break;case"string":n+='"'+escape(e[t])+'"';break;case"object":n+='"'+sjcl.codec.base64.fromBits(e[t],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return n+"}"},decode:function(e){if(e=e.replace(/\s/g,""),!e.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t,s,n={};for(s=0;s<e.length;s++){if(!(t=e[s].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+/%*_.@=-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null!=t[3]?n[t[2]]=parseInt(t[3],10):null!=t[4]?n[t[2]]=t[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(t[4]):unescape(t[4]):null!=t[5]&&(n[t[2]]="true"===t[5])}return n},g:function(e,t,n){if(0[0]===e&&(e={}),0[0]===t)return e;for(var s in t)if(t.hasOwnProperty(s)){if(n&&0[0]!==e[s]&&e[s]!==t[s])throw new sjcl.exception.invalid("required parameter overridden");e[s]=t[s]}return e},sa:function(e,t){var n,s={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(s[n]=e[n]);return s},ra:function(e,t){var n,s={};for(n=0;n<t.length;n++)0[0]!==e[t[n]]&&(s[t[n]]=e[t[n]]);return s}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.pa={},sjcl.misc.cachedPbkdf2=function(e,t){var s,n=sjcl.misc.pa;return t=t||{},s=t.iter||1e3,n=n[e]=n[e]||{},s=n[s]=n[s]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):sjcl.random.randomWords(2,0)},n=0[0]===t.salt?s.firstSalt:t.salt,s[n]=s[n]||sjcl.misc.pbkdf2(e,n,t.iter),{key:s[n].slice(0),salt:n.slice(0)}},"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl})