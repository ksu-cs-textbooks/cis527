<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="YouTube Video Resources Join in Active Directory Domain from Server-World How to Join Ubuntu 18.04 / Debian 10 To Active Directory (AD) Domain from Computingforgeeks Video Transcript In the following two videos, we’ll look at how to enable interoperability between our Windows- and Linux-based systems. In many organizations today, you’ll have a mix of many different operating systems, so it is very helpful to understand how to integrate them together in a single directory service."><meta name=author content="Russell Feldhausen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux Client on Windows Domain :: CIS 527 Textbook"><meta name=twitter:description content="YouTube Video Resources Join in Active Directory Domain from Server-World How to Join Ubuntu 18.04 / Debian 10 To Active Directory (AD) Domain from Computingforgeeks Video Transcript In the following two videos, we’ll look at how to enable interoperability between our Windows- and Linux-based systems. In many organizations today, you’ll have a mix of many different operating systems, so it is very helpful to understand how to integrate them together in a single directory service."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis527/4-directory-services/09-linux-client-on-windows-domain/"><meta property="og:site_name" content="CIS 527 Textbook"><meta property="og:title" content="Linux Client on Windows Domain :: CIS 527 Textbook"><meta property="og:description" content="YouTube Video Resources Join in Active Directory Domain from Server-World How to Join Ubuntu 18.04 / Debian 10 To Active Directory (AD) Domain from Computingforgeeks Video Transcript In the following two videos, we’ll look at how to enable interoperability between our Windows- and Linux-based systems. In many organizations today, you’ll have a mix of many different operating systems, so it is very helpful to understand how to integrate them together in a single directory service."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Directory Services"><meta property="article:modified_time" content="2020-05-27T18:23:42-05:00"><meta itemprop=name content="Linux Client on Windows Domain :: CIS 527 Textbook"><meta itemprop=description content="YouTube Video Resources Join in Active Directory Domain from Server-World How to Join Ubuntu 18.04 / Debian 10 To Active Directory (AD) Domain from Computingforgeeks Video Transcript In the following two videos, we’ll look at how to enable interoperability between our Windows- and Linux-based systems. In many organizations today, you’ll have a mix of many different operating systems, so it is very helpful to understand how to integrate them together in a single directory service."><meta itemprop=dateModified content="2020-05-27T18:23:42-05:00"><meta itemprop=wordCount content="1328"><title>Linux Client on Windows Domain :: CIS 527 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis527/4-directory-services/09-linux-client-on-windows-domain/ rel=canonical type=text/html title="Linux Client on Windows Domain :: CIS 527 Textbook"><link href=/cis527/4-directory-services/09-linux-client-on-windows-domain/index.xml rel=alternate type=application/rss+xml title="Linux Client on Windows Domain :: CIS 527 Textbook"><link href=/cis527/4-directory-services/09-linux-client-on-windows-domain/tele.html rel=alternate type=text/html title="Linux Client on Windows Domain :: CIS 527 Textbook"><link href=/cis527/4-directory-services/09-linux-client-on-windows-domain/embed.html rel=alternate type=text/html title="Linux Client on Windows Domain :: CIS 527 Textbook"><link href=/cis527/css/fontawesome-all.min.css?1723138194 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fontawesome-all.min.css?1723138194 rel=stylesheet></noscript><link href=/cis527/css/nucleus.css?1723138194 rel=stylesheet><link href=/cis527/css/auto-complete.css?1723138194 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/auto-complete.css?1723138194 rel=stylesheet></noscript><link href=/cis527/css/perfect-scrollbar.min.css?1723138194 rel=stylesheet><link href=/cis527/css/fonts.css?1723138194 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fonts.css?1723138194 rel=stylesheet></noscript><link href=/cis527/css/theme.css?1723138194 rel=stylesheet><link href=/cis527/css/theme-auto.css?1723138194 rel=stylesheet id=R-variant-style><link href=/cis527/css/chroma-auto.css?1723138194 rel=stylesheet id=R-variant-chroma-style><link href=/cis527/css/variant.css?1723138194 rel=stylesheet><link href=/cis527/css/print.css?1723138194 rel=stylesheet media=print><link href=/cis527/css/format-print.css?1723138194 rel=stylesheet><script src=/cis527/js/variant.js?1723138194></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis527",window.index_js_url="/cis527/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis527/css/custom.css?1723138194 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis527/4-directory-services/09-linux-client-on-windows-domain/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis527/4-directory-services/><span itemprop=name>Directory Services</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Linux Client on Windows Domain</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis527/4-directory-services/08-ubuntu-client-configuration/ title="Ubuntu Client Configuration (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis527/4-directory-services/10-windows-client-on-linux-domain/ title="Windows Client on Linux Domain (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=linux-client-on-windows-domain>Linux Client on Windows Domain</h1><a href="https://www.youtube.com/watch?v=uyie_GWK2zw">YouTube Video</a><h4 id=resources>Resources</h4><ul><li><a href="https://www.server-world.info/en/note?os=Ubuntu_20.04&p=realmd" rel=external target=_blank>Join in Active Directory Domain</a> from Server-World</li><li><a href=https://computingforgeeks.com/join-ubuntu-debian-to-active-directory-ad-domain/ rel=external target=_blank>How to Join Ubuntu 18.04 / Debian 10 To Active Directory (AD) Domain</a> from Computingforgeeks</li></ul><h4 id=video-transcript>Video Transcript</h4><p>In the following two videos, we&rsquo;ll look at how to enable interoperability between our Windows- and Linux-based systems. In many organizations today, you&rsquo;ll have a mix of many different operating systems, so it is very helpful to understand how to integrate them together in a single directory service.</p><p>In this video, I&rsquo;ll show you how to add an Ubuntu VM to a Windows Active Directory Domain. This is by far the most common use-case for interoperability, and has been used by many organizations including K-State. For most users, Windows Active Directory provides a great set of features for Windows-based systems, and it is simple to integrate Linux and Mac clients into that environment.</p><p>For this example, I&rsquo;m using the Windows 2019 server set up as defined in Lab 4&rsquo;s assignment. I&rsquo;ve reconfigured the domain to have the fully qualified domain name <code>ad.cis527russfeld.cs.ksu.edu</code> for this example, as you would in a real environment. This is due to the fact that many Linux packages do not accept the <code>.local</code> top-level domain I used in the previous video as an example.</p><p>For the client, I am using a copy of my Ubuntu 20.04 VM labelled <strong>CLIENT</strong> from Lab 3. For this assignment, you&rsquo;ll use that same VM, but restored to a snapshot taken before it was configured as a client for OpenLDAP. Remember that you&rsquo;ll need create this snapshot before you start the Lab 4 assignment, or else you may need to create a new VM for this activity.</p><p>Finally, I&rsquo;ve found there really isn&rsquo;t a great guide for doing this online, but I&rsquo;m generally following the instructions in the Server-World guide linked below this video. I&rsquo;ll do my best to clarify what parts are important and what parts I leave out and why.</p><p>First, as with any client I wish to add to a domain, I&rsquo;ll need to set a static DNS entry to point to the domain controller itself. For the second entry, I&rsquo;ll just use the VMware router as always. Once I&rsquo;ve done that, I&rsquo;ll disable and enable the network connection so that my changes take effect.</p><p>Then, I&rsquo;ll need to install the <code>realmd</code> package. This package allows us to interface with Active Directory Domain servers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install realmd</span></span></code></pre></div><p>The instructions found online typically have you install a large number of packages at this step, but don&rsquo;t do a good job of describing what they are used for. Thankfully, Ubuntu 20.04 includes a special program called <code>packagekit</code> by default, which allows us to automatically install the packages we need as we need them. So, we&rsquo;ll start by just installing <code>realmd</code> and going from there.</p><p>Once we have <code>realmd</code> installed, we can use it to query our Active Directory domain using the <code>realm discover</code> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>realm discover ad.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>If that command works correctly, you should see output giving information about the Active Directory Domain we just queried. However, if you get an error at this step, that usually means that something isn&rsquo;t working correctly. In that case, double-check that you have properly set your DNS entries, and that you can ping your Windows 2019 server using both the IP address and the Active Directory Domain name. You&rsquo;ll need to be able to use DNS to resolve that domain name in order for this system to join the domain.</p><p>Once we are ready to join the domain, we can simply using the <code>sudo realm join</code> command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo realm join ad.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>Once we enter that command, we&rsquo;ll be prompted for the password for the <code>Administrator</code> account. This is the <code>Administrator</code> account of our Active Directory domain, so we&rsquo;ll have to provide the correct password here.</p><p>Here&rsquo;s where the cool part happens. The <code>realmd</code> program is smart enough to know what packages we need in order to interface with an Active Directory domain, and because we have <code>packagekit</code> installed on Ubuntu 20.04 by default, the <code>realmd</code> command can automatically install those packages when we use the <code>realm join</code> command. So, we don&rsquo;t have to worry about remembering to install all of these packages manually - it is done for us automatically! Very handy!</p><p>Ok, now that we have joined the domain, we can see if we can get information about an Active Directory user account using the <code>id</code> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>id russfeld@ad.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>If everything is working correctly, you should see some information about that user printed to the screen. If not, you&rsquo;ll need to do some troubleshooting.</p><p>Now, we can even log in as that user using the <code>su</code>, or &ldquo;switch user&rdquo; command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su russfeld@ad.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>There we go! We are now logged in to this system as one of our Active Directory users. However, there are couple of things we can do to improve this experience. First, notice that we have to enter our fully qualified domain name for our Active Directory domain to log in. That can get really annoying, espeically with a long domain like ours. Also, what if we try to check our home directory:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/</span></span></code></pre></div><p>We find out that this user doesn&rsquo;t even have a home directory to store files in. That&rsquo;s no good!</p><p>So, let&rsquo;s log out of this user and try to fix these issues.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>exit</span></span></code></pre></div><p>First, let&rsquo;s change a setting so that we don&rsquo;t have to enter the full Active Directory Domain name each time we want to log in as one of those users. To do that, we&rsquo;ll edit the <code>sssd</code> configuration file. The <code>sssd</code> package helps provide access to authentication resources across many different sources.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/sssd/sssd.conf</span></span></code></pre></div><p>In that file, we&rsquo;ll see a line like the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>use<span class=nb>_</span>fully<span class=nb>_</span>qualified<span class=nb>_</span>names = True</span></span></code></pre></div><p>We&rsquo;ll simply set that setting to <code>False</code> and then save the file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>use<span class=nb>_</span>fully<span class=nb>_</span>qualified<span class=nb>_</span>names = False</span></span></code></pre></div><p>Finally, we can restart the <code>sssd</code> daemon to load the new settings.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart sssd</span></span></code></pre></div><p>Now, we can use the <code>id</code> command with just the username:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>id russfeld</span></span></code></pre></div><p>and we should get the correct info. We can even use that username to log in to the system using the <code>su</code> command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su russfeld
</span></span><span class=line><span class=cl>exit</span></span></code></pre></div><p>Yay! Now, let&rsquo;s tackle the creation of home directories. This is handled by the Pluggable Authentication Modules, or PAM, framework. There are many ways to do this, including editing a config file manually. However, there is a quick and easy way to do this as well, using the <code>pam-auth-update</code> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pam-auth-update</span></span></code></pre></div><p>In the menu, press the <kbd>SPACE</kbd> key to enable the &ldquo;Create home directory on login&rdquo; option, then press <kbd>ENTER</kbd> to save the changes.</p><p>There we go! Now, when we log in as our domain user, it will automatically create a home directory for us:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su russfeld
</span></span><span class=line><span class=cl><span class=nb>cd</span> ~/
</span></span><span class=line><span class=cl>pwd</span></span></code></pre></div><p>Awesome! Now, one interesting thing to discuss at this point is the fact that many online tutorials require us to install the <code>oddjob</code> and <code>oddjob-mkhomedir</code> packages. As far as I can tell, these are only required if we are using <code>selinux</code> instead of <code>apparmor</code> to protect our system. Since we aren&rsquo;t doing that, we&rsquo;ll just leave this out for now. However, if you do decide to use <code>selinux</code> on your system, you may have to do some additional configuration in order for your home directories to be properly created.</p><p>Ok, the last thing we may want to tackle on this system is the ability for our domain users to log on graphically. In previous versions of Ubuntu, this required a bit more configuration. However, in Ubuntu 20.04, all we have to do is restart the system to reload a few of the changes we just made. Then, we can click the &ldquo;Not listed?&rdquo; option at the bottom of the login window, and enter our domain username and password.</p><p>Voila! That&rsquo;s all it takes to log on graphically using an Active Directory domain user account on Ubuntu 20.04. The process has gotten much simpler over the years, to the point where it isn&rsquo;t that much more difficult than adding a Windows 10 client to a domain.</p><footer class=footline></footer></article></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Russell Feldhausen
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis527/commit/9183251a925ba5836d8771be0a4096927130f01d>May 27, 2020</a></p></div></div><script src=/cis527/js/clipboard.min.js?1723138194 defer></script><script src=/cis527/js/perfect-scrollbar.min.js?1723138194 defer></script><script src=/cis527/js/theme.js?1723138194 defer></script></body></html>