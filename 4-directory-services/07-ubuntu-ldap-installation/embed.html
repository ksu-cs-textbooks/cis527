<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Note PHPLDAPAdmin no longer works on Ubuntu 24.04 since it has several incompatibility issues with PHP 8+. The assignment has been updated to use the new LDAP Account Manager (LAM) software instead. You may ignore the part of this video showing how to configure PHPLDAPAdmin and instead refer to the guide linked from the assignment page to configure LAM.
Resources How to Install OpenLDAP on Ubuntu 22.04 from HowToForge (works for Ubuntu 24."><meta name=author content="Russell Feldhausen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ubuntu LDAP Installation :: CIS 527 Textbook"><meta name=twitter:description content="Note PHPLDAPAdmin no longer works on Ubuntu 24.04 since it has several incompatibility issues with PHP 8+. The assignment has been updated to use the new LDAP Account Manager (LAM) software instead. You may ignore the part of this video showing how to configure PHPLDAPAdmin and instead refer to the guide linked from the assignment page to configure LAM.
Resources How to Install OpenLDAP on Ubuntu 22.04 from HowToForge (works for Ubuntu 24."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis527/4-directory-services/07-ubuntu-ldap-installation/embed.html"><meta property="og:site_name" content="CIS 527 Textbook"><meta property="og:title" content="Ubuntu LDAP Installation :: CIS 527 Textbook"><meta property="og:description" content="Note PHPLDAPAdmin no longer works on Ubuntu 24.04 since it has several incompatibility issues with PHP 8+. The assignment has been updated to use the new LDAP Account Manager (LAM) software instead. You may ignore the part of this video showing how to configure PHPLDAPAdmin and instead refer to the guide linked from the assignment page to configure LAM.
Resources How to Install OpenLDAP on Ubuntu 22.04 from HowToForge (works for Ubuntu 24."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Directory Services"><meta property="article:modified_time" content="2024-08-08T16:02:35-05:00"><meta itemprop=name content="Ubuntu LDAP Installation :: CIS 527 Textbook"><meta itemprop=description content="Note PHPLDAPAdmin no longer works on Ubuntu 24.04 since it has several incompatibility issues with PHP 8+. The assignment has been updated to use the new LDAP Account Manager (LAM) software instead. You may ignore the part of this video showing how to configure PHPLDAPAdmin and instead refer to the guide linked from the assignment page to configure LAM.
Resources How to Install OpenLDAP on Ubuntu 22.04 from HowToForge (works for Ubuntu 24."><meta itemprop=dateModified content="2024-08-08T16:02:35-05:00"><meta itemprop=wordCount content="1507"><title>Ubuntu LDAP Installation :: CIS 527 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis527/4-directory-services/07-ubuntu-ldap-installation/ rel=canonical type=text/html title="Ubuntu LDAP Installation :: CIS 527 Textbook"><link href=/cis527/4-directory-services/07-ubuntu-ldap-installation/index.xml rel=alternate type=application/rss+xml title="Ubuntu LDAP Installation :: CIS 527 Textbook"><link href=/cis527/4-directory-services/07-ubuntu-ldap-installation/index.print.html rel=alternate type=text/html title="Ubuntu LDAP Installation :: CIS 527 Textbook"><link href=/cis527/4-directory-services/07-ubuntu-ldap-installation/tele.html rel=alternate type=text/html title="Ubuntu LDAP Installation :: CIS 527 Textbook"><link href=/cis527/css/fontawesome-all.min.css?1729634974 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fontawesome-all.min.css?1729634974 rel=stylesheet></noscript><link href=/cis527/css/nucleus.css?1729634974 rel=stylesheet><link href=/cis527/css/auto-complete.css?1729634974 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/auto-complete.css?1729634974 rel=stylesheet></noscript><link href=/cis527/css/perfect-scrollbar.min.css?1729634974 rel=stylesheet><link href=/cis527/css/fonts.css?1729634974 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis527/css/fonts.css?1729634974 rel=stylesheet></noscript><link href=/cis527/css/theme.css?1729634974 rel=stylesheet><link href=/cis527/css/theme-light-theme.css?1729634974 rel=stylesheet id=R-variant-style><link href=/cis527/css/chroma-relearn-light.css?1729634974 rel=stylesheet id=R-variant-chroma-style><link href=/cis527/css/variant.css?1729634974 rel=stylesheet><link href=/cis527/css/print.css?1729634974 rel=stylesheet media=print><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis527",window.index_js_url="/cis527/index.search.js",window.variants&&variants.init(["light-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis527/css/custom.css?1729634974 rel=stylesheet></head><body class="mobile-support embed disableInlineCopyToClipboard" data-url=/cis527/4-directory-services/07-ubuntu-ldap-installation/embed.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/zIUDIiAMGrg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>PHPLDAPAdmin no longer works on Ubuntu 24.04 since it has several incompatibility issues with PHP 8+. The assignment has been updated to use the new LDAP Account Manager (LAM) software instead. You may ignore the part of this video showing how to configure PHPLDAPAdmin and instead refer to the guide linked from the assignment page to configure LAM.</p></div></div><h4 id=resources>Resources</h4><ul><li><a href=https://www.howtoforge.com/how-to-install-openldap-on-ubuntu-22-04/ rel=external target=_blank>How to Install OpenLDAP on Ubuntu 22.04</a> from HowToForge (works for Ubuntu 24.04)<ul><li>Note: In this document, you can skip the steps of manually adding groups and users to LDAP before install LDAP Account Manager. Once LAM is configured, it will automatically add the default OUs for groups and users.</li></ul></li><li><a href=https://ubuntu.com/server/docs/ldap-and-transport-layer-security-tls rel=external target=_blank>LDAP & TLS</a> from the Ubuntu Server Guide</li><li><a href="https://www.youtube.com/watch?v=T4Df5_cojAs" rel=external target=_blank>How Does HTTPS Work</a> from kubucation on YouTube (a good overview of CAs and certificates)</li><li><strong><a href=/cis527/3-core-networking-services/15-security/embed.html>Core Networking Services - Security</a></strong></li><li><strong><a href=/cis527/5-the-cloud/06-certificates/embed.html>The Cloud - Certificates</a></strong></li></ul><h4 id=video-transcript>Video Transcript</h4><p>As we did earlier with setting up Active Directory on Windows, let&rsquo;s take a look at the steps required to install and configure OpenLDAP on Linux. The goal of this video isn&rsquo;t to show you all the steps of the process, but provide commentary on some of the more confusing steps you&rsquo;ll perform.</p><p>For this example, I&rsquo;m using the Ubuntu VM labelled Server from Lab 3. I have chosen to disable the DHCP server on this system, and instead have replaced it with the VMware DHCP server. In practice, that change should not affect any of this process. Also, I&rsquo;ll generally be following the guide from DigitalOcean, which is linked in the resources section below the video.</p><p>At this point, I have also already performed the first steps of the guide, which is to install the <code>slapd</code> and <code>ldap-utils</code> packages on this system. Now, I&rsquo;ll step through the configuration process for <code>slapd</code> and discuss the various options it presents.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg-reconfigure slapd</span></span></code></pre></div><p>First, it will ask you if you want to omit the OpenLDAP server configuration. Make sure you select <code>&lt;No></code> for that option. You can use the arrow keys (<kbd>←</kbd> and <kbd>→</kbd>) to move the red-shaded selector to the option you&rsquo;d like to select, then press <kbd>ENTER</kbd> to confirm it.</p><p>Next, it will ask for your domain name. For this example, I&rsquo;ll just use <code>ldap.cis527russfeld.cs.ksu.edu</code>. You&rsquo;ll need to adjust these settings to match the required configuration for the lab assignment. This matches the DNS configuration I made in Lab 3, which is very important later on in this process.</p><p>Next, it will also ask for your organization name. I&rsquo;ll just use <code>cis527</code> here.</p><p>Then, it will ask for your Administrator password. This is the equivalent of the <code>root</code> account within the domain. It is able to change all domain settings, and therefore the password for this account should be very complex and well protected. For this example, I&rsquo;ll just use the same password we are using for everything else, but in practice you&rsquo;ll want to carefully consider this password.</p><p>The next option is whether you want to have the database removed if you purge the <code>slapd</code> package. Selecting <code>&lt;yes></code> on this option would delete your LDAP database if you ever chose to reinstall the <code>slapd</code> package. For most uses, you&rsquo;ll always want to select <code>&lt;no></code> here, which is what I&rsquo;ll do.</p><p>Since there are some existing configuration files in place, the installer asks if you&rsquo;d like those to be moved. Unless you are reinstalling <code>slapd</code> on an existing server, you can select <code>&lt;yes></code> for this option.</p><p>That should complete the configuration for the OpenLDAP server. For this example, I have disabled the firewall on this system, but for your lab assignment you&rsquo;ll need to do a bit of firewall configuration at this point.</p><hr><p>Finally, let&rsquo;s add some encryption to this server to protect the information shared across the network. This step was not required in previous versions of this lab, but it has always been a good idea. Now that Ubuntu uses SSSD, or System Security Services Daemon, for authentication, it requires us to provide TLS encryption on our LDAP server. So, let&rsquo;s do that now.</p><p>For these steps, we&rsquo;ll be closely following the Ubuntu Server Guide linked below this video. We&rsquo;ll be adjusting a few of the items to match our configuration, but most of the commands are exactly the same.</p><p>First, we&rsquo;ll need to install a couple of packages to allow us to create and manipulate security certificates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install gnutls-bin ssl-cert</span></span></code></pre></div><p>Next, we need to create our own certificate authority, or CA. In a production system, you would instead work with an actual CA to obtain a security certificate from them, but that can be time consuming and expensive. So, for this example, we&rsquo;ll just create our own. Also, contrary to what your browser may lead you to believe, using your own CA certificates will result in an encrypted connection, it just may not be &ldquo;trusted&rdquo; since your browser doesn&rsquo;t recognize the CA certificate.</p><p>If you want to know more about CAs and certificates, check out the handy YouTube video I&rsquo;ve linked below this video. It gives a great description of how certificates work in much more detail. I&rsquo;ve also included links to the lectures in Module 3 and Module 5 that deal with TLS certificates.</p><p>So, we&rsquo;ll first create a private key for our CA:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certtool --generate-privkey --bits <span class=m>4096</span> --outfile /etc/ssl/private/mycakey.pem</span></span></code></pre></div><p>Then, we&rsquo;ll create a template file that contains the options we need for creating this certificate. Notice here that I&rsquo;ve modified this information from what is provided in the Ubuntu Server Guide document to match our setup:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/ssl/ca.info</span></span></code></pre></div><p>and put the following text into that file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>cn = CIS 527
</span></span><span class=line><span class=cl>ca
</span></span><span class=line><span class=cl>cert<span class=nb>_</span>signing<span class=nb>_</span>key
</span></span><span class=line><span class=cl>expiration<span class=nb>_</span>days = 3650</span></span></code></pre></div><p>Then, we can use that template to create our self-signed certificate authority certificate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certtool --generate-self-signed --load-privkey /etc/ssl/private/mycakey.pem --template /etc/ssl/ca.info --outfile /usr/local/share/ca-certificates/mycacert.crt</span></span></code></pre></div><p>This will create a certificate called <code>mycacert.crt</code> that is stored in <code>/usr/local/share/ca-certificates/</code>. <strong>This is our self-signed CA certificate</strong>. So, whenever we want any system to trust one of our self-signed certificates that we make from our CA, we&rsquo;ll need to make sure that system has a copy of this CA certificate in its list of trusted certificates.</p><p>To do that, we simply place the certificate in <code>/usr/local/share/ca-certificates/</code>, and then run the following command to add it to the list of trusted certificates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo update-ca-certificates</span></span></code></pre></div><p>If that command works correctly, it should tell us that it has added 1 certificate to our list.</p><p>Before we move on, let&rsquo;s make a copy of our <code>mycacert.crt</code> file in our <code>cis527</code> users&rsquo;s home directory. We&rsquo;ll use this file in the next part of this lab when we are configuring our client system to authenticate using LDAP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp /usr/local/share/ca-certificates/mycacert.crt ~/</span></span></code></pre></div><p>Now that we&rsquo;ve created our own self-signed CA, we can use it to create a certificate for our LDAP server. So, we&rsquo;ll start by creating yet another private key:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certtool --generate-privkey --bits <span class=m>2048</span> --outfile /etc/ldap/ldap01_slapd_key.pem</span></span></code></pre></div><p>Then, we&rsquo;ll create another template file to give the information about the certificate that we&rsquo;d like to create:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/ssl/ldap01.info</span></span></code></pre></div><p>and place the following tex in that file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>organization = CIS 527
</span></span><span class=line><span class=cl>cn = ldap.cis527russfeld.cs.ksu.edu
</span></span><span class=line><span class=cl>tls<span class=nb>_</span>www<span class=nb>_</span>server
</span></span><span class=line><span class=cl>encryption<span class=nb>_</span>key
</span></span><span class=line><span class=cl>signing<span class=nb>_</span>key
</span></span><span class=line><span class=cl>expiration<span class=nb>_</span>days = 365</span></span></code></pre></div><p>Notice that in that file, we entered the fully qualified domain name for our LDAP server on the second line. This is the most important part that makes all of this work. On our client machine, we must have a DNS entry that links this domain name to our LDAP server&rsquo;s IP address, and then the certificate the server uses must match that domain name. So, if we don&rsquo;t get this step right, the whole system may not work correctly until we fix it!</p><p>Finally, we can use this long and complex command to create and sign our server&rsquo;s certificate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certtool --generate-certificate --load-privkey /etc/ldap/ldap01_slapd_key.pem --load-ca-certificate /etc/ssl/certs/mycacert.pem --load-ca-privkey /etc/ssl/private/mycakey.pem --template /etc/ssl/ldap01.info --outfile /etc/ldap/ldap01_slapd_cert.pem</span></span></code></pre></div><p>Once the certificate has been created, we just need to do a couple of tweaks so that it has the correct permissions. This will allow the LDAP server to properly access the file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chgrp openldap /etc/ldap/ldap01_slapd_key.pem
</span></span><span class=line><span class=cl>sudo chmod <span class=m>0640</span> /etc/ldap/ldap01_slapd_key.pem</span></span></code></pre></div><p>Finally, at long last, we are ready to tell our LDAP server to use the certificate. To do that, we&rsquo;ll create an LDIF file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano ~/certinfo.ldif</span></span></code></pre></div><p>and in that file we&rsquo;ll put the information about our certificate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>dn: cn=config
</span></span><span class=line><span class=cl>add: olcTLSCACertificateFile
</span></span><span class=line><span class=cl>olcTLSCACertificateFile: /etc/ssl/certs/mycacert.pem
</span></span><span class=line><span class=cl>-
</span></span><span class=line><span class=cl>add: olcTLSCertificateFile
</span></span><span class=line><span class=cl>olcTLSCertificateFile: /etc/ldap/ldap01<span class=nb>_</span>slapd<span class=nb>_</span>cert.pem
</span></span><span class=line><span class=cl>-
</span></span><span class=line><span class=cl>add: olcTLSCertificateKeyFile
</span></span><span class=line><span class=cl>olcTLSCertificateKeyFile: /etc/ldap/ldap01<span class=nb>_</span>slapd<span class=nb>_</span>key.pem</span></span></code></pre></div><p>Once that file is created, we can use the <code>ldapmodify</code> tool to import it into our server:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ldapmodify -Y EXTERNAL -H ldapi:/// -f certinfo.ldif</span></span></code></pre></div><p>Whew! That was a lot of work! Now, if we did everything correctly, we should be able to query this LDAP server using TLS. The best way to check that is by using the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ldapwhoami -x -ZZ -h ldap.cis527russfeld.cs.ksu.edu</span></span></code></pre></div><p>The <code>-ZZ</code> part of that command tells it to use TLS, and if it works correctly it should return <code>anonymous</code> as the result. If this step fails, then you may need to do some troubleshooting to see what the problem is.</p><p>That should do it! In the next video, I&rsquo;ll show how to configure another Ubuntu VM to use this LDAP server for authentication.</p><footer class=footline></footer></article></div></main></div><script src=/cis527/js/clipboard.min.js?1729634974 defer></script><script src=/cis527/js/perfect-scrollbar.min.js?1729634974 defer></script><script src=/cis527/js/theme.js?1729634974 defer></script><script src=/cis527/js/embed-iframe.js?1729634974 defer></script></body></html>